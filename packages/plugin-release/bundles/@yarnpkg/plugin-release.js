/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-release",
factory: function (require) {
var plugin=(()=>{var pn=Object.create,ae=Object.defineProperty,gn=Object.defineProperties,yn=Object.getOwnPropertyDescriptor,mn=Object.getOwnPropertyDescriptors,wn=Object.getOwnPropertyNames,Tt=Object.getOwnPropertySymbols,bn=Object.getPrototypeOf,Mt=Object.prototype.hasOwnProperty,_n=Object.prototype.propertyIsEnumerable;var xt=(e,t,r)=>t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Z=(e,t)=>{for(var r in t||(t={}))Mt.call(t,r)&&xt(e,r,t[r]);if(Tt)for(var r of Tt(t))_n.call(t,r)&&xt(e,r,t[r]);return e},At=(e,t)=>gn(e,mn(t)),vn=e=>ae(e,"__esModule",{value:!0});var v=e=>{if(typeof require!="undefined")return require(e);throw new Error('Dynamic require of "'+e+'" is not supported')};var E=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ct=(e,t)=>{for(var r in t)ae(e,r,{get:t[r],enumerable:!0})},Rn=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of wn(t))!Mt.call(e,n)&&n!=="default"&&ae(e,n,{get:()=>t[n],enumerable:!(r=yn(t,n))||r.enumerable});return e},M=e=>Rn(vn(ae(e!=null?pn(bn(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var Pt=E((Wa,Dt)=>{Dt.exports=function(t,r,n,i){let a=t.split(".").filter(c=>i.date.indexOf(c)!==-1),o=r.length>0?r.split(/[.-]/):[],s=Array(12).fill(1).map((c,g)=>(g+1).toString()),h=Array(12).fill(1).map((c,g)=>(g>8?"":"0")+(g+1)),w=Array(52).fill(1).map((c,g)=>(g+1).toString()),u=Array(52).fill(1).map((c,g)=>(g>8?"":"0")+(g+1)),l=Array(31).fill(1).map((c,g)=>(g+1).toString()),d=Array(31).fill(1).map((c,g)=>(g>8?"":"0")+(g+1)),f={};if(o.length>0)for(let c=0;c<a.length;c++){let g=a[c],D=o[c];y(g,D),f[g]=D}function y(c,g){if(c=="YYYY"&&/^[0-9]{4}$/.test(g)!==!0)throw new Error("Invalid year.");if(c=="YY"&&/^[0-9]{1,3}$/.test(g)!==!0)throw new Error("Invalid year.");if(c=="0Y"&&/^[0-9]{2,3}$/.test(g)!==!0)throw new Error("Invalid year.");if(c=="MM"&&s.indexOf(g)===-1)throw new Error("Invalid month.");if(c=="0M"&&h.indexOf(g)===-1)throw new Error("Invalid month.");if(c=="WW"&&w.indexOf(g)===-1)throw new Error("Invalid week.");if(c=="0W"&&u.indexOf(g)===-1)throw new Error("Invalid week.");if(c=="DD"&&l.indexOf(g)===-1)throw new Error("Invalid day.");if(c=="0D"&&d.indexOf(g)===-1)throw new Error("Invalid day.");return!0}function R(c){if(c=="YYYY")return n.getUTCFullYear();if(c=="YY")return parseInt(n.getUTCFullYear().toString().slice(1));if(c=="0Y"){let g=n.getUTCFullYear().toString().slice(1);return(g.length==1?"0":"")+g}if(c=="MM")return n.getUTCMonth()+1;if(c=="0M"){let g=n.getUTCMonth()+1;return(g<10?"0":"")+g}if(c=="WW")return p(n,{zeroPadded:!1});if(c=="0W")return p(n,{zeroPadded:!0});if(c=="DD")return n.getUTCDate();if(c=="0D"){let g=n.getUTCDate();return(g<10?"0":"")+g}}function p(c,g={zeroPadded:!1}){let D=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate())),ie=D.getUTCDay()||7;D.setUTCDate(D.getUTCDate()+4-ie);let we=new Date(Date.UTC(D.getUTCFullYear(),0,1)),Ye=Math.ceil(((D-we)/864e5+1)/7);return g.zeroPadded&&Ye<10?"0"+Ye:Ye}function _(){let c=R("YYYY"),g=parseInt(c.toString().slice(0,1))*1e3;return f.hasOwnProperty("YYYY")?parseInt(f.YYYY):f.hasOwnProperty("YY")?parseInt(f.YY)+g:f.hasOwnProperty("0Y")?parseInt(f["0Y"])+g:parseInt(c)}function C(){return(f.hasOwnProperty("MM")?parseInt(f.MM):f.hasOwnProperty("0M")?parseInt(f["0M"]):1)-1}function T(){return f.hasOwnProperty("DD")?parseInt(f.DD):f.hasOwnProperty("0D")?parseInt(f["0D"]):1}function S(){return Date.UTC(_(),C(),T())}function Fe(c){if(c!=="CALENDAR")return!1;let g=!1;for(let D=0;D<a.length;D++){let ie=a[D],we=R(ie);Number(f[ie])!==we&&(g=!0),f[ie]=we.toString()}return g}function cn(){return Object.keys(f).map(c=>f[c]).join(".")}function hn(c=void 0){return new Date(S()).toLocaleString(c,{year:"numeric",month:"long",timeZone:"UTC"})}return{inc:Fe,asString:cn,asNumeric:S,pretty:hn}}});var It=E((Ba,Nt)=>{Nt.exports=function(t,r,n){let i=t.split(".").filter(u=>n.semantic.indexOf(u)!==-1),a=r.length>0?r.split(/[.-]/):[];t.split(".").filter(u=>n.date.indexOf(u)!==-1).map(u=>a.shift());let s={};for(let u=0;u<i.length;u++){let l=i[u];a.length===0?s[l]=n.modifier.indexOf(l)!==-1?"modifier.0":"0":s[l]=l=="MODIFIER"&&a.length==u+2?a[u]+"."+a[u+1]:l=="MODIFIER"&&a.length!=u+2?"modifier.0":a[u]}function h(u){if(["DEV","ALPHA","BETA","RC"].indexOf(u)!==-1){let l=s.MODIFIER.split(".")[0].toUpperCase()!=u,d=s.MODIFIER.split(".")[1];s.MODIFIER=u.toLowerCase()+"."+(s.MODIFIER=="modifier.0"||l?"1":parseInt(d)+1)}if(["MAJOR","MINOR","MICRO"].indexOf(u)!==-1)switch(s[u]=(Number(s[u])+1).toString(),s.MODIFIER="",u){case"MINOR":s.hasOwnProperty("MICRO")&&(s.MICRO="0");break;case"MAJOR":s.hasOwnProperty("MICRO")&&(s.MICRO="0"),s.hasOwnProperty("MINOR")&&(s.MINOR="0");break}u==="CALENDAR"&&(s.MODIFIER="",s.hasOwnProperty("MICRO")&&(s.MICRO="0"),s.hasOwnProperty("MINOR")&&(s.MINOR="0"),s.hasOwnProperty("MAJOR")&&(s.MAJOR="0"))}function w(){return Object.keys(s).filter(u=>s[u]&&u!="MODIFIER").map(u=>s[u]).join(".")+(s.MODIFIER&&s.MODIFIER!="modifier.0"?"-"+s.MODIFIER:"")}return{inc:h,asString:w}}});var jt=E((Fa,Lt)=>{var be=Pt(),_e=It();function En(){let e={date:["YYYY","YY","0Y","MM","0M","WW","0W","DD","0D"],semantic:["MAJOR","MINOR","MICRO","MODIFIER"],modifier:["DEV","ALPHA","BETA","RC"]},t=["CALENDAR","MAJOR","MINOR","MICRO",...e.modifier],r={now:new Date(Date.now())};function n(l,d){return l=l.toUpperCase(),u(l),w(d,l),be(l,d,r.now,e),_e(l,d,e),!0}function i(l){l=u(l,{transformModifiers:!1});let d=be(l,"",r.now,e),f=_e(l,"",e),y=l.split(".").filter(_=>e.semantic.indexOf(_)!==-1);y.length>0&&f.inc(y[0]),l.split(".").filter(_=>e.date.indexOf(_)!==-1).length>0&&(d.inc("CALENDAR"),f.inc("CALENDAR"));let p=l.split(".").filter(_=>e.modifier.indexOf(_)!==-1);return p.length>0&&f.inc(p[0]),[d.asString(),f.asString()].filter(_=>_).join(".")}function a(l,d,f){l=u(l),d=w(d,l),f=h(f,l);let y=be(l,d,r.now,e),R=_e(l,d,e),p=!1;for(let C of f.split("."))C==="CALENDAR"?y.inc(C)&&(p=!0,R.inc("CALENDAR")):(!p||e.modifier.includes(C))&&R.inc(C);let _=[y.asString(),R.asString()].filter(C=>C).join(".");if(d===_)throw new Error("There is no change in the version.");return _}function o(l,d,f=void 0){l=u(l),d=w(d,l);let y=be(l,d,r.now,e),R=_e(l,d,e);return y.pretty(f)+" v"+R.asString()+""}function s(l){return l=l.toUpperCase(),e.date.indexOf(l)!==-1?"date":e.semantic.indexOf(l)!==-1?"semantic":e.modifier.indexOf(l)!==-1?"modifier":""}function h(l,d){if(!l)throw new Error("Please specify a valid level.");l=l.trim().toUpperCase();let f=d.split("."),y=l.split(".");if(y.length>2)throw new Error("You can specify 2 levels at max.");if(!y)throw new Error("You should specify at least one level.");for(var R=0;R<y.length;R++){let p=y[R];if(t.indexOf(p)===-1)throw new Error("Invalid level.");if(e.modifier.indexOf(p)!==-1&&f.indexOf("MODIFIER")===-1)throw new Error("Level and format doesn't match.");if(e.semantic.indexOf(p)!==-1&&f.indexOf(p)===-1)throw new Error("Level and format doesn't match.")}return l}function w(l,d){if(!l)throw new Error("Please specify a valid version.");if(l=l.trim().toLowerCase(),/[^a-zA-Z0-9.-]/.test(l)===!0)throw new Error("Unexpected characters in your version string.");let f=d.split("."),y=l.split(/[.-]/);if(f.indexOf("MODIFIER")===-1&&y.length<f.length||f.indexOf("MODIFIER")!==-1&&y.length+1!=f.length&&y.length-1!=f.length)throw new Error("Version and format lengths mismatch.");return l}function u(l,d={transformModifiers:!0}){if(!l)throw new Error("Please specify a valid format.");l=l.trim().toUpperCase().split(".").map(T=>e.modifier.indexOf(T)!==-1&&d.transformModifiers===!0?"MODIFIER":T).join(".");let f=[],y=l.split(".");for(let T=0;T<y.length;T++){let S=y[T].toUpperCase();if(e.date.indexOf(S)===-1&&e.semantic.indexOf(S)===-1&&e.modifier.indexOf(S)===-1)throw new Error("Your format contains invalid tags.");if(f.indexOf(S)!==-1)throw new Error("Your format is repeating the same tag.");f.push(S)}let R=f.filter(T=>e.date.indexOf(T)!==-1),p=null;if(R.length>0){let T=e.date.filter(S=>R.indexOf(S)!==-1);for(let S=0;S<T.length;S++){if(T[S]!=R[S])throw new Error("Date tags are in the wrong order.");p=f.indexOf(R[S])}}let _=f.filter(T=>e.semantic.indexOf(T)!==-1),C=null;if(_.length>0){let T=e.semantic.filter(S=>_.indexOf(S)!==-1);for(let S=0;S<T.length;S++){if(T[S]!=_[S])throw new Error("Semantic tags are in the wrong order.");C===null&&(C=f.indexOf(_[S]))}}if(p!==null&&C!==null&&p>C)throw new Error("Semantic tags should come after date tags.");return l}return{init:i,inc:a,pretty:o,getTagType:s,valid:n}}Lt.exports=En()});var Ut=E((Ya,kt)=>{"use strict";var Sn=v("process"),On=v("child_process").exec,qt=v("semver").valid,Tn=/tag:\s*(.+?)[,)]/gi,Mn="git log --decorate --no-color",xn=/.+-\w+\.\d+$/;function An(e,t){return t&&!new RegExp("^"+t+"@").test(e)?!1:/^.+@[0-9]+\.[0-9]+\.[0-9]+(-.+)?$/.test(e)}kt.exports=function(t,r){typeof t=="function"&&(r=t,t={});let n=Object.assign({maxBuffer:Infinity,cwd:Sn.cwd()},t);if(n.package&&!n.lernaTags){r(new Error("opts.package should only be used when running in lerna mode"));return}On(Mn,n,function(i,a){if(i){r(i);return}let o=[],s;n.tagPrefix&&(s=new RegExp("^"+n.tagPrefix+"(.*)")),a.split(`
`).forEach(function(h){let w;for(;w=Tn.exec(h);){let u=w[1];if(!(n.skipUnstable&&xn.test(u)))if(n.lernaTags)An(u,n.package)&&o.push(u);else if(n.tagPrefix){let l=u.match(s);l&&qt(l[1])&&o.push(u)}else qt(u)&&o.push(u)}}),r(null,o)})}});var Ve=E((Ka,zt)=>{zt.exports=v("stream")});var er=E((za,Qt)=>{"use strict";function Zt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Dn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zt(Object(r),!0).forEach(function(n){Pn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zt(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function In(e,t,r){return t&&Xt(e.prototype,t),r&&Xt(e,r),e}var Ln=v("buffer"),Ee=Ln.Buffer,jn=v("util"),Ge=jn.inspect,qn=Ge&&Ge.custom||"inspect";function kn(e,t,r){Ee.prototype.copy.call(e,t,r)}Qt.exports=function(){function e(){Nn(this,e),this.head=null,this.tail=null,this.length=0}return In(e,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return Ee.alloc(0);for(var n=Ee.allocUnsafe(r>>>0),i=this.head,a=0;i;)kn(i.data,n,a),a+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,a=n.data;for(r-=a.length;n=n.next;){var o=n.data,s=r>o.length?o.length:r;if(s===o.length?a+=o:a+=o.slice(0,r),r-=s,r===0){s===o.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(s));break}++i}return this.length-=i,a}},{key:"_getBuffer",value:function(r){var n=Ee.allocUnsafe(r),i=this.head,a=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var o=i.data,s=r>o.length?o.length:r;if(o.copy(n,n.length-r,0,s),r-=s,r===0){s===o.length?(++a,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(s));break}++a}return this.length-=a,n}},{key:qn,value:function(r,n){return Ge(this,Dn({},n,{depth:0,customInspect:!1}))}}]),e}()});var Ke=E((Za,rr)=>{"use strict";function Un(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Je,this,e)):process.nextTick(Je,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(a){!t&&a?r._writableState?r._writableState.errorEmitted?process.nextTick(Se,r):(r._writableState.errorEmitted=!0,process.nextTick(tr,r,a)):process.nextTick(tr,r,a):t?(process.nextTick(Se,r),t(a)):process.nextTick(Se,r)}),this)}function tr(e,t){Je(e,t),Se(e)}function Se(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function Wn(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Je(e,t){e.emit("error",t)}function Bn(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}rr.exports={destroy:Un,undestroy:Wn,errorOrDestroy:Bn}});var U=E((Xa,ar)=>{"use strict";var nr={};function P(e,t,r){r||(r=Error);function n(a,o,s){return typeof t=="string"?t:t(a,o,s)}class i extends r{constructor(o,s,h){super(n(o,s,h))}}i.prototype.name=r.name,i.prototype.code=e,nr[e]=i}function ir(e,t){if(Array.isArray(e)){let r=e.length;return e=e.map(n=>String(n)),r>2?`one of ${t} ${e.slice(0,r-1).join(", ")}, or `+e[r-1]:r===2?`one of ${t} ${e[0]} or ${e[1]}`:`of ${t} ${e[0]}`}else return`of ${t} ${String(e)}`}function Fn(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function Yn(e,t,r){return(r===void 0||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function Hn(e,t,r){return typeof r!="number"&&(r=0),r+t.length>e.length?!1:e.indexOf(t,r)!==-1}P("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError);P("ERR_INVALID_ARG_TYPE",function(e,t,r){let n;typeof t=="string"&&Fn(t,"not ")?(n="must not be",t=t.replace(/^not /,"")):n="must be";let i;if(Yn(e," argument"))i=`The ${e} ${n} ${ir(t,"type")}`;else{let a=Hn(e,".")?"property":"argument";i=`The "${e}" ${a} ${n} ${ir(t,"type")}`}return i+=`. Received type ${typeof r}`,i},TypeError);P("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");P("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"});P("ERR_STREAM_PREMATURE_CLOSE","Premature close");P("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"});P("ERR_MULTIPLE_CALLBACK","Callback called multiple times");P("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");P("ERR_STREAM_WRITE_AFTER_END","write after end");P("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);P("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError);P("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");ar.exports.codes=nr});var ze=E((Qa,or)=>{"use strict";var $n=U().codes.ERR_INVALID_OPT_VALUE;function Vn(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function Gn(e,t,r,n){var i=Vn(t,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var a=n?r:"highWaterMark";throw new $n(a,i)}return Math.floor(i)}return e.objectMode?16:16*1024}or.exports={getHighWaterMark:Gn}});var sr=E((eo,Ze)=>{typeof Object.create=="function"?Ze.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Ze.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}}});var Q=E((to,Qe)=>{try{if(Xe=v("util"),typeof Xe.inherits!="function")throw"";Qe.exports=Xe.inherits}catch(e){Qe.exports=sr()}var Xe});var fr=E((ro,lr)=>{lr.exports=v("util").deprecate});var rt=E((no,gr)=>{"use strict";gr.exports=O;function ur(e){var t=this;this.next=null,this.entry=null,this.finish=function(){_i(t,e)}}var ee;O.WritableState=le;var Jn={deprecate:fr()},dr=Ve(),Oe=v("buffer").Buffer,Kn=global.Uint8Array||function(){};function zn(e){return Oe.from(e)}function Zn(e){return Oe.isBuffer(e)||e instanceof Kn}var et=Ke(),Xn=ze(),Qn=Xn.getHighWaterMark,W=U().codes,ei=W.ERR_INVALID_ARG_TYPE,ti=W.ERR_METHOD_NOT_IMPLEMENTED,ri=W.ERR_MULTIPLE_CALLBACK,ni=W.ERR_STREAM_CANNOT_PIPE,ii=W.ERR_STREAM_DESTROYED,ai=W.ERR_STREAM_NULL_VALUES,oi=W.ERR_STREAM_WRITE_AFTER_END,si=W.ERR_UNKNOWN_ENCODING,te=et.errorOrDestroy;Q()(O,dr);function li(){}function le(e,t,r){ee=ee||$(),e=e||{},typeof r!="boolean"&&(r=t instanceof ee),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=Qn(this,e,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=e.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){gi(t,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=e.emitClose!==!1,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new ur(this)}le.prototype.getBuffer=function(){for(var t=this.bufferedRequest,r=[];t;)r.push(t),t=t.next;return r};(function(){try{Object.defineProperty(le.prototype,"buffer",{get:Jn.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}})();var Te;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Te=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(t){return Te.call(this,t)?!0:this!==O?!1:t&&t._writableState instanceof le}})):Te=function(t){return t instanceof this};function O(e){ee=ee||$();var t=this instanceof ee;if(!t&&!Te.call(O,this))return new O(e);this._writableState=new le(e,this,t),this.writable=!0,e&&(typeof e.write=="function"&&(this._write=e.write),typeof e.writev=="function"&&(this._writev=e.writev),typeof e.destroy=="function"&&(this._destroy=e.destroy),typeof e.final=="function"&&(this._final=e.final)),dr.call(this)}O.prototype.pipe=function(){te(this,new ni)};function fi(e,t){var r=new oi;te(e,r),process.nextTick(t,r)}function ui(e,t,r,n){var i;return r===null?i=new ai:typeof r!="string"&&!t.objectMode&&(i=new ei("chunk",["string","Buffer"],r)),i?(te(e,i),process.nextTick(n,i),!1):!0}O.prototype.write=function(e,t,r){var n=this._writableState,i=!1,a=!n.objectMode&&Zn(e);return a&&!Oe.isBuffer(e)&&(e=zn(e)),typeof t=="function"&&(r=t,t=null),a?t="buffer":t||(t=n.defaultEncoding),typeof r!="function"&&(r=li),n.ending?fi(this,r):(a||ui(this,n,e,r))&&(n.pendingcb++,i=ci(this,n,a,e,t,r)),i};O.prototype.cork=function(){this._writableState.corked++};O.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest&&hr(this,e))};O.prototype.setDefaultEncoding=function(t){if(typeof t=="string"&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new si(t);return this._writableState.defaultEncoding=t,this};Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function di(e,t,r){return!e.objectMode&&e.decodeStrings!==!1&&typeof t=="string"&&(t=Oe.from(t,r)),t}Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ci(e,t,r,n,i,a){if(!r){var o=di(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var h=t.length<t.highWaterMark;if(h||(t.needDrain=!0),t.writing||t.corked){var w=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},w?w.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else tt(e,t,!1,s,n,i,a);return h}function tt(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new ii("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function hi(e,t,r,n,i){--t.pendingcb,r?(process.nextTick(i,n),process.nextTick(fe,e,t),e._writableState.errorEmitted=!0,te(e,n)):(i(n),e._writableState.errorEmitted=!0,te(e,n),fe(e,t))}function pi(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function gi(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new ri;if(pi(r),t)hi(e,r,n,t,i);else{var a=pr(r)||e.destroyed;!a&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&hr(e,r),n?process.nextTick(cr,e,r,a,i):cr(e,r,a,i)}}function cr(e,t,r,n){r||yi(e,t),t.pendingcb--,n(),fe(e,t)}function yi(e,t){t.length===0&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function hr(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),a=t.corkedRequestsFree;a.entry=r;for(var o=0,s=!0;r;)i[o]=r,r.isBuf||(s=!1),r=r.next,o+=1;i.allBuffers=s,tt(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new ur(t),t.bufferedRequestCount=0}else{for(;r;){var h=r.chunk,w=r.encoding,u=r.callback,l=t.objectMode?1:h.length;if(tt(e,t,!1,l,h,w,u),r=r.next,t.bufferedRequestCount--,t.writing)break}r===null&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}O.prototype._write=function(e,t,r){r(new ti("_write()"))};O.prototype._writev=null;O.prototype.end=function(e,t,r){var n=this._writableState;return typeof e=="function"?(r=e,e=null,t=null):typeof t=="function"&&(r=t,t=null),e!=null&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||bi(this,n,r),this};Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function pr(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function mi(e,t){e._final(function(r){t.pendingcb--,r&&te(e,r),t.prefinished=!0,e.emit("prefinish"),fe(e,t)})}function wi(e,t){!t.prefinished&&!t.finalCalled&&(typeof e._final=="function"&&!t.destroyed?(t.pendingcb++,t.finalCalled=!0,process.nextTick(mi,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function fe(e,t){var r=pr(t);if(r&&(wi(e,t),t.pendingcb===0&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}function bi(e,t,r){t.ending=!0,fe(e,t),r&&(t.finished?process.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function _i(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){!this._writableState||(this._writableState.destroyed=t)}});O.prototype.destroy=et.destroy;O.prototype._undestroy=et.undestroy;O.prototype._destroy=function(e,t){t(e)}});var $=E((io,mr)=>{"use strict";var vi=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};mr.exports=I;var yr=at(),nt=rt();Q()(I,yr);for(it=vi(nt.prototype),Me=0;Me<it.length;Me++)xe=it[Me],I.prototype[xe]||(I.prototype[xe]=nt.prototype[xe]);var it,xe,Me;function I(e){if(!(this instanceof I))return new I(e);yr.call(this,e),nt.call(this,e),this.allowHalfOpen=!0,e&&(e.readable===!1&&(this.readable=!1),e.writable===!1&&(this.writable=!1),e.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",Ri)))}Object.defineProperty(I.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(I.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(I.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ri(){this._writableState.ended||process.nextTick(Ei,this)}function Ei(e){e.end()}Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}})});var _r=E((ot,br)=>{var Ae=v("buffer"),L=Ae.Buffer;function wr(e,t){for(var r in e)t[r]=e[r]}L.from&&L.alloc&&L.allocUnsafe&&L.allocUnsafeSlow?br.exports=Ae:(wr(Ae,ot),ot.Buffer=V);function V(e,t,r){return L(e,t,r)}V.prototype=Object.create(L.prototype);wr(L,V);V.from=function(e,t,r){if(typeof e=="number")throw new TypeError("Argument must not be a number");return L(e,t,r)};V.alloc=function(e,t,r){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=L(e);return t!==void 0?typeof r=="string"?n.fill(t,r):n.fill(t):n.fill(0),n};V.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return L(e)};V.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Ae.SlowBuffer(e)}});var ft=E(Rr=>{"use strict";var st=_r().Buffer,vr=st.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Si(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function Oi(e){var t=Si(e);if(typeof t!="string"&&(st.isEncoding===vr||!vr(e)))throw new Error("Unknown encoding: "+e);return t||e}Rr.StringDecoder=ue;function ue(e){this.encoding=Oi(e);var t;switch(this.encoding){case"utf16le":this.text=Di,this.end=Pi,t=4;break;case"utf8":this.fillLast=xi,t=4;break;case"base64":this.text=Ni,this.end=Ii,t=3;break;default:this.write=Li,this.end=ji;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=st.allocUnsafe(t)}ue.prototype.write=function(e){if(e.length===0)return"";var t,r;if(this.lastNeed){if(t=this.fillLast(e),t===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""};ue.prototype.end=Ci;ue.prototype.text=Ai;ue.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function lt(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function Ti(e,t,r){var n=t.length-1;if(n<r)return 0;var i=lt(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||i===-2?0:(i=lt(t[n]),i>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||i===-2?0:(i=lt(t[n]),i>=0?(i>0&&(i===2?i=0:e.lastNeed=i-3),i):0))}function Mi(e,t,r){if((t[0]&192)!=128)return e.lastNeed=0,"\uFFFD";if(e.lastNeed>1&&t.length>1){if((t[1]&192)!=128)return e.lastNeed=1,"\uFFFD";if(e.lastNeed>2&&t.length>2&&(t[2]&192)!=128)return e.lastNeed=2,"\uFFFD"}}function xi(e){var t=this.lastTotal-this.lastNeed,r=Mi(this,e,t);if(r!==void 0)return r;if(this.lastNeed<=e.length)return e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length}function Ai(e,t){var r=Ti(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)}function Ci(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\uFFFD":t}function Di(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function Pi(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function Ni(e,t){var r=(e.length-t)%3;return r===0?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function Ii(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function Li(e){return e.toString(this.encoding)}function ji(e){return e&&e.length?this.write(e):""}});var Ce=E((oo,Or)=>{"use strict";var Er=U().codes.ERR_STREAM_PREMATURE_CLOSE;function qi(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}function ki(){}function Ui(e){return e.setHeader&&typeof e.abort=="function"}function Sr(e,t,r){if(typeof t=="function")return Sr(e,null,t);t||(t={}),r=qi(r||ki);var n=t.readable||t.readable!==!1&&e.readable,i=t.writable||t.writable!==!1&&e.writable,a=function(){e.writable||s()},o=e._writableState&&e._writableState.finished,s=function(){i=!1,o=!0,n||r.call(e)},h=e._readableState&&e._readableState.endEmitted,w=function(){n=!1,h=!0,i||r.call(e)},u=function(y){r.call(e,y)},l=function(){var y;if(n&&!h)return(!e._readableState||!e._readableState.ended)&&(y=new Er),r.call(e,y);if(i&&!o)return(!e._writableState||!e._writableState.ended)&&(y=new Er),r.call(e,y)},d=function(){e.req.on("finish",s)};return Ui(e)?(e.on("complete",s),e.on("abort",l),e.req?d():e.on("request",d)):i&&!e._writableState&&(e.on("end",a),e.on("close",a)),e.on("end",w),e.on("finish",s),t.error!==!1&&e.on("error",u),e.on("close",l),function(){e.removeListener("complete",s),e.removeListener("abort",l),e.removeListener("request",d),e.req&&e.req.removeListener("finish",s),e.removeListener("end",a),e.removeListener("close",a),e.removeListener("finish",s),e.removeListener("end",w),e.removeListener("error",u),e.removeListener("close",l)}}Or.exports=Sr});var Mr=E((so,Tr)=>{"use strict";var De;function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wi=Ce(),F=Symbol("lastResolve"),G=Symbol("lastReject"),de=Symbol("error"),Pe=Symbol("ended"),J=Symbol("lastPromise"),ut=Symbol("handlePromise"),K=Symbol("stream");function Y(e,t){return{value:e,done:t}}function Bi(e){var t=e[F];if(t!==null){var r=e[K].read();r!==null&&(e[J]=null,e[F]=null,e[G]=null,t(Y(r,!1)))}}function Fi(e){process.nextTick(Bi,e)}function Yi(e,t){return function(r,n){e.then(function(){if(t[Pe]){r(Y(void 0,!0));return}t[ut](r,n)},n)}}var Hi=Object.getPrototypeOf(function(){}),$i=Object.setPrototypeOf((De={get stream(){return this[K]},next:function(){var t=this,r=this[de];if(r!==null)return Promise.reject(r);if(this[Pe])return Promise.resolve(Y(void 0,!0));if(this[K].destroyed)return new Promise(function(o,s){process.nextTick(function(){t[de]?s(t[de]):o(Y(void 0,!0))})});var n=this[J],i;if(n)i=new Promise(Yi(n,this));else{var a=this[K].read();if(a!==null)return Promise.resolve(Y(a,!1));i=new Promise(this[ut])}return this[J]=i,i}},B(De,Symbol.asyncIterator,function(){return this}),B(De,"return",function(){var t=this;return new Promise(function(r,n){t[K].destroy(null,function(i){if(i){n(i);return}r(Y(void 0,!0))})})}),De),Hi),Vi=function(t){var r,n=Object.create($i,(r={},B(r,K,{value:t,writable:!0}),B(r,F,{value:null,writable:!0}),B(r,G,{value:null,writable:!0}),B(r,de,{value:null,writable:!0}),B(r,Pe,{value:t._readableState.endEmitted,writable:!0}),B(r,ut,{value:function(a,o){var s=n[K].read();s?(n[J]=null,n[F]=null,n[G]=null,a(Y(s,!1))):(n[F]=a,n[G]=o)},writable:!0}),r));return n[J]=null,Wi(t,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var a=n[G];a!==null&&(n[J]=null,n[F]=null,n[G]=null,a(i)),n[de]=i;return}var o=n[F];o!==null&&(n[J]=null,n[F]=null,n[G]=null,o(Y(void 0,!0))),n[Pe]=!0}),t.on("readable",Fi.bind(null,n)),n};Tr.exports=Vi});var Dr=E((lo,Cr)=>{"use strict";function xr(e,t,r,n,i,a,o){try{var s=e[a](o),h=s.value}catch(w){r(w);return}s.done?t(h):Promise.resolve(h).then(n,i)}function Gi(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(h){xr(a,n,i,o,s,"next",h)}function s(h){xr(a,n,i,o,s,"throw",h)}o(void 0)})}}function Ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ji(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ar(Object(r),!0).forEach(function(n){Ki(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ar(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ki(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var zi=U().codes.ERR_INVALID_ARG_TYPE;function Zi(e,t,r){var n;if(t&&typeof t.next=="function")n=t;else if(t&&t[Symbol.asyncIterator])n=t[Symbol.asyncIterator]();else if(t&&t[Symbol.iterator])n=t[Symbol.iterator]();else throw new zi("iterable",["Iterable"],t);var i=new e(Ji({objectMode:!0},r)),a=!1;i._read=function(){a||(a=!0,o())};function o(){return s.apply(this,arguments)}function s(){return s=Gi(function*(){try{var h=yield n.next(),w=h.value,u=h.done;u?i.push(null):i.push(yield w)?o():a=!1}catch(l){i.destroy(l)}}),s.apply(this,arguments)}return i}Cr.exports=Zi});var at=E((uo,Br)=>{"use strict";Br.exports=b;var re;b.ReadableState=Nr;var fo=v("events").EventEmitter,Pr=function(t,r){return t.listeners(r).length},ce=Ve(),Ne=v("buffer").Buffer,Xi=global.Uint8Array||function(){};function Qi(e){return Ne.from(e)}function ea(e){return Ne.isBuffer(e)||e instanceof Xi}var dt=v("util"),m;dt&&dt.debuglog?m=dt.debuglog("stream"):m=function(){};var ta=er(),ct=Ke(),ra=ze(),na=ra.getHighWaterMark,Ie=U().codes,ia=Ie.ERR_INVALID_ARG_TYPE,aa=Ie.ERR_STREAM_PUSH_AFTER_EOF,oa=Ie.ERR_METHOD_NOT_IMPLEMENTED,sa=Ie.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,ne,ht,pt;Q()(b,ce);var he=ct.errorOrDestroy,gt=["error","close","destroy","pause","resume"];function la(e,t,r){if(typeof e.prependListener=="function")return e.prependListener(t,r);!e._events||!e._events[t]?e.on(t,r):Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]}function Nr(e,t,r){re=re||$(),e=e||{},typeof r!="boolean"&&(r=t instanceof re),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=na(this,e,"readableHighWaterMark",r),this.buffer=new ta,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=e.emitClose!==!1,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(ne||(ne=ft().StringDecoder),this.decoder=new ne(e.encoding),this.encoding=e.encoding)}function b(e){if(re=re||$(),!(this instanceof b))return new b(e);var t=this instanceof re;this._readableState=new Nr(e,this,t),this.readable=!0,e&&(typeof e.read=="function"&&(this._read=e.read),typeof e.destroy=="function"&&(this._destroy=e.destroy)),ce.call(this)}Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){!this._readableState||(this._readableState.destroyed=t)}});b.prototype.destroy=ct.destroy;b.prototype._undestroy=ct.undestroy;b.prototype._destroy=function(e,t){t(e)};b.prototype.push=function(e,t){var r=this._readableState,n;return r.objectMode?n=!0:typeof e=="string"&&(t=t||r.defaultEncoding,t!==r.encoding&&(e=Ne.from(e,t),t=""),n=!0),Ir(this,e,t,!1,n)};b.prototype.unshift=function(e){return Ir(this,e,null,!0,!1)};function Ir(e,t,r,n,i){m("readableAddChunk",t);var a=e._readableState;if(t===null)a.reading=!1,da(e,a);else{var o;if(i||(o=fa(a,t)),o)he(e,o);else if(a.objectMode||t&&t.length>0)if(typeof t!="string"&&!a.objectMode&&Object.getPrototypeOf(t)!==Ne.prototype&&(t=Qi(t)),n)a.endEmitted?he(e,new sa):yt(e,a,t,!0);else if(a.ended)he(e,new aa);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||t.length!==0?yt(e,a,t,!1):mt(e,a)):yt(e,a,t,!1)}else n||(a.reading=!1,mt(e,a))}return!a.ended&&(a.length<a.highWaterMark||a.length===0)}function yt(e,t,r,n){t.flowing&&t.length===0&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&Le(e)),mt(e,t)}function fa(e,t){var r;return!ea(t)&&typeof t!="string"&&t!==void 0&&!e.objectMode&&(r=new ia("chunk",["string","Buffer","Uint8Array"],t)),r}b.prototype.isPaused=function(){return this._readableState.flowing===!1};b.prototype.setEncoding=function(e){ne||(ne=ft().StringDecoder);var t=new ne(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var Lr=1073741824;function ua(e){return e>=Lr?e=Lr:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function jr(e,t){return e<=0||t.length===0&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=ua(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}b.prototype.read=function(e){m("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(e!==0&&(t.emittedReadable=!1),e===0&&t.needReadable&&((t.highWaterMark!==0?t.length>=t.highWaterMark:t.length>0)||t.ended))return m("read: emitReadable",t.length,t.ended),t.length===0&&t.ended?bt(this):Le(this),null;if(e=jr(e,t),e===0&&t.ended)return t.length===0&&bt(this),null;var n=t.needReadable;m("need readable",n),(t.length===0||t.length-e<t.highWaterMark)&&(n=!0,m("length less than watermark",n)),t.ended||t.reading?(n=!1,m("reading or ended",n)):n&&(m("do read"),t.reading=!0,t.sync=!0,t.length===0&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=jr(r,t)));var i;return e>0?i=Ur(e,t):i=null,i===null?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),t.length===0&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&bt(this)),i!==null&&this.emit("data",i),i};function da(e,t){if(m("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?Le(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,qr(e)))}}function Le(e){var t=e._readableState;m("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(m("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(qr,e))}function qr(e){var t=e._readableState;m("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,wt(e)}function mt(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(ca,e,t))}function ca(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&t.length===0);){var r=t.length;if(m("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}b.prototype._read=function(e){he(this,new oa("_read()"))};b.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e);break}n.pipesCount+=1,m("pipe count=%d opts=%j",n.pipesCount,t);var i=(!t||t.end!==!1)&&e!==process.stdout&&e!==process.stderr,a=i?s:R;n.endEmitted?process.nextTick(a):r.once("end",a),e.on("unpipe",o);function o(p,_){m("onunpipe"),p===r&&_&&_.hasUnpiped===!1&&(_.hasUnpiped=!0,u())}function s(){m("onend"),e.end()}var h=ha(r);e.on("drain",h);var w=!1;function u(){m("cleanup"),e.removeListener("close",f),e.removeListener("finish",y),e.removeListener("drain",h),e.removeListener("error",d),e.removeListener("unpipe",o),r.removeListener("end",s),r.removeListener("end",R),r.removeListener("data",l),w=!0,n.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&h()}r.on("data",l);function l(p){m("ondata");var _=e.write(p);m("dest.write",_),_===!1&&((n.pipesCount===1&&n.pipes===e||n.pipesCount>1&&Wr(n.pipes,e)!==-1)&&!w&&(m("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function d(p){m("onerror",p),R(),e.removeListener("error",d),Pr(e,"error")===0&&he(e,p)}la(e,"error",d);function f(){e.removeListener("finish",y),R()}e.once("close",f);function y(){m("onfinish"),e.removeListener("close",f),R()}e.once("finish",y);function R(){m("unpipe"),r.unpipe(e)}return e.emit("pipe",r),n.flowing||(m("pipe resume"),r.resume()),e};function ha(e){return function(){var r=e._readableState;m("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&Pr(e,"data")&&(r.flowing=!0,wt(e))}}b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(t.pipesCount===0)return this;if(t.pipesCount===1)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=Wr(t.pipes,e);return o===-1?this:(t.pipes.splice(o,1),t.pipesCount-=1,t.pipesCount===1&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)};b.prototype.on=function(e,t){var r=ce.prototype.on.call(this,e,t),n=this._readableState;return e==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):e==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,m("on readable",n.length,n.reading),n.length?Le(this):n.reading||process.nextTick(pa,this)),r};b.prototype.addListener=b.prototype.on;b.prototype.removeListener=function(e,t){var r=ce.prototype.removeListener.call(this,e,t);return e==="readable"&&process.nextTick(kr,this),r};b.prototype.removeAllListeners=function(e){var t=ce.prototype.removeAllListeners.apply(this,arguments);return(e==="readable"||e===void 0)&&process.nextTick(kr,this),t};function kr(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function pa(e){m("readable nexttick read 0"),e.read(0)}b.prototype.resume=function(){var e=this._readableState;return e.flowing||(m("resume"),e.flowing=!e.readableListening,ga(this,e)),e.paused=!1,this};function ga(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(ya,e,t))}function ya(e,t){m("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),wt(e),t.flowing&&!t.reading&&e.read(0)}b.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function wt(e){var t=e._readableState;for(m("flow",t.flowing);t.flowing&&e.read()!==null;);}b.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;e.on("end",function(){if(m("wrapped end"),r.decoder&&!r.ended){var o=r.decoder.end();o&&o.length&&t.push(o)}t.push(null)}),e.on("data",function(o){if(m("wrapped data"),r.decoder&&(o=r.decoder.write(o)),!(r.objectMode&&o==null)&&!(!r.objectMode&&(!o||!o.length))){var s=t.push(o);s||(n=!0,e.pause())}});for(var i in e)this[i]===void 0&&typeof e[i]=="function"&&(this[i]=function(s){return function(){return e[s].apply(e,arguments)}}(i));for(var a=0;a<gt.length;a++)e.on(gt[a],this.emit.bind(this,gt[a]));return this._read=function(o){m("wrapped _read",o),n&&(n=!1,e.resume())},this};typeof Symbol=="function"&&(b.prototype[Symbol.asyncIterator]=function(){return ht===void 0&&(ht=Mr()),ht(this)});Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(b.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(b.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}});b._fromList=Ur;Object.defineProperty(b.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Ur(e,t){if(t.length===0)return null;var r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(t.decoder?r=t.buffer.join(""):t.buffer.length===1?r=t.buffer.first():r=t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r}function bt(e){var t=e._readableState;m("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(ma,t,e))}function ma(e,t){if(m("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&e.length===0&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}typeof Symbol=="function"&&(b.from=function(e,t){return pt===void 0&&(pt=Dr()),pt(b,e,t)});function Wr(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}});var _t=E((co,Yr)=>{"use strict";Yr.exports=k;var je=U().codes,wa=je.ERR_METHOD_NOT_IMPLEMENTED,ba=je.ERR_MULTIPLE_CALLBACK,_a=je.ERR_TRANSFORM_ALREADY_TRANSFORMING,va=je.ERR_TRANSFORM_WITH_LENGTH_0,qe=$();Q()(k,qe);function Ra(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new ba);r.writechunk=null,r.writecb=null,t!=null&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function k(e){if(!(this instanceof k))return new k(e);qe.call(this,e),this._transformState={afterTransform:Ra.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",Ea)}function Ea(){var e=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(t,r){Fr(e,t,r)}):Fr(this,null,null)}k.prototype.push=function(e,t){return this._transformState.needTransform=!1,qe.prototype.push.call(this,e,t)};k.prototype._transform=function(e,t,r){r(new wa("_transform()"))};k.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};k.prototype._read=function(e){var t=this._transformState;t.writechunk!==null&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};k.prototype._destroy=function(e,t){qe.prototype._destroy.call(this,e,function(r){t(r)})};function Fr(e,t,r){if(t)return e.emit("error",t);if(r!=null&&e.push(r),e._writableState.length)throw new va;if(e._transformState.transforming)throw new _a;return e.push(null)}});var Vr=E((ho,$r)=>{"use strict";$r.exports=pe;var Hr=_t();Q()(pe,Hr);function pe(e){if(!(this instanceof pe))return new pe(e);Hr.call(this,e)}pe.prototype._transform=function(e,t,r){r(null,e)}});var Zr=E((po,zr)=>{"use strict";var vt;function Sa(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}var Gr=U().codes,Oa=Gr.ERR_MISSING_ARGS,Ta=Gr.ERR_STREAM_DESTROYED;function Jr(e){if(e)throw e}function Ma(e){return e.setHeader&&typeof e.abort=="function"}function xa(e,t,r,n){n=Sa(n);var i=!1;e.on("close",function(){i=!0}),vt===void 0&&(vt=Ce()),vt(e,{readable:t,writable:r},function(o){if(o)return n(o);i=!0,n()});var a=!1;return function(o){if(!i&&!a){if(a=!0,Ma(e))return e.abort();if(typeof e.destroy=="function")return e.destroy();n(o||new Ta("pipe"))}}}function Kr(e){e()}function Aa(e,t){return e.pipe(t)}function Ca(e){return!e.length||typeof e[e.length-1]!="function"?Jr:e.pop()}function Da(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Ca(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Oa("streams");var i,a=t.map(function(o,s){var h=s<t.length-1,w=s>0;return xa(o,h,w,function(u){i||(i=u),u&&a.forEach(Kr),!h&&(a.forEach(Kr),n(i))})});return t.reduce(Aa)}zr.exports=Da});var Xr=E((N,ye)=>{var ge=v("stream");process.env.READABLE_STREAM==="disable"&&ge?(ye.exports=ge.Readable,Object.assign(ye.exports,ge),ye.exports.Stream=ge):(N=ye.exports=at(),N.Stream=ge||N,N.Readable=N,N.Writable=rt(),N.Duplex=$(),N.Transform=_t(),N.PassThrough=Vr(),N.finished=Ce(),N.pipeline=Zr())});var tn=E((go,en)=>{en.exports=Qr;function Qr(e,t){if(e&&t)return Qr(e)(t);if(typeof e!="function")throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(n){r[n]=e[n]}),r;function r(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];var a=e.apply(this,n),o=n[n.length-1];return typeof a=="function"&&a!==o&&Object.keys(o).forEach(function(s){a[s]=o[s]}),a}}});var an=E((yo,Rt)=>{var rn=tn();Rt.exports=rn(ke);Rt.exports.strict=rn(nn);ke.proto=ke(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return ke(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return nn(this)},configurable:!0})});function ke(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function nn(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}});var fn=E((mo,ln)=>{var on=Xr(),Pa=an();function Na(e){return sn(e,{objectMode:!0,highWaterMark:16})}function Ia(e){return sn(e)}function sn(e,t){if(!e||typeof e=="function"||e._readableState)return e;let r=new on.Readable(t).wrap(e);return e.destroy&&(r.destroy=e.destroy.bind(e)),r}var Ue=class extends on.Readable{constructor(t,r){super(At(Z({},r),{autoDestroy:!0}));this._drained=!1,this._forwarding=!1,this._current=null,this._toStreams2=r&&r.objectMode?Na:Ia,typeof t=="function"?this._queue=t:(this._queue=t.map(this._toStreams2),this._queue.forEach(n=>{typeof n!="function"&&this._attachErrorListener(n)})),this._next()}_read(){this._drained=!0,this._forward()}_forward(){if(this._forwarding||!this._drained||!this._current)return;this._forwarding=!0;let t;for(;this._drained&&(t=this._current.read())!==null;)this._drained=this.push(t);this._forwarding=!1}_destroy(t,r){let n=[];if(this._current&&n.push(this._current),typeof this._queue!="function"&&(n=n.concat(this._queue)),n.length===0)r(t);else{let i=n.length,a=t;n.forEach(o=>{La(o,t,s=>{a=a||s,--i==0&&r(a)})})}}_next(){if(this._current=null,typeof this._queue=="function")this._queue((t,r)=>{if(t)return this.destroy(t);r=this._toStreams2(r),this._attachErrorListener(r),this._gotNextStream(r)});else{let t=this._queue.shift();typeof t=="function"&&(t=this._toStreams2(t()),this._attachErrorListener(t)),this._gotNextStream(t)}}_gotNextStream(t){if(!t){this.push(null);return}this._current=t,this._forward();let r=()=>{this._forward()},n=()=>{if(!t._readableState.ended&&!t.destroyed){let a=new Error("ERR_STREAM_PREMATURE_CLOSE");a.code="ERR_STREAM_PREMATURE_CLOSE",this.destroy(a)}},i=()=>{this._current=null,t.removeListener("readable",r),t.removeListener("end",i),t.removeListener("close",n),t.destroy(),this._next()};t.on("readable",r),t.once("end",i),t.once("close",n)}_attachErrorListener(t){if(!t)return;let r=n=>{t.removeListener("error",r),this.destroy(n)};t.once("error",r)}};Ue.obj=e=>new Ue(e,{objectMode:!0,highWaterMark:16});ln.exports=Ue;function La(e,t,r){if(!e.destroy||e.destroyed)r(t);else{let n=Pa(i=>r(i||t));e.on("error",n).on("close",()=>n()).destroy(t,n)}}});var ka={};Ct(ka,{default:()=>qa,releaseUtils:()=>$e});var Ot=M(v("@yarnpkg/core"));var Jt=M(v("@yarnpkg/cli")),A=M(v("@yarnpkg/core")),q=M(v("clipanion"));var $e={};Ct($e,{changelogStream:()=>oe,recommendedBump:()=>He});var ve=M(v("@yarnpkg/core")),Wt=M(v("@yarnpkg/fslib")),Bt=M(v("@yarnpkg/plugin-pnp")),Ft=M(jt()),Yt=M(Ut()),Ht=M(v("module")),X=M(v("semver")),Re=M(v("util")),$t={patch:1,minor:2,major:3},Vt=(0,Re.promisify)(Yt.default);async function oe(e,...t){let{cwd:r,locator:n,manifest:i,project:a}=e,[o,s,h]=t;return Gt(a.cwd)("conventional-changelog")(Z({preset:a.configuration.get("conventionalChangelogPreset"),pkg:{transform:()=>i.exportTo({version:n.reference})},lernaPackage:e===a.topLevelWorkspace?void 0:ve.structUtils.stringifyIdent(e.locator),tagPrefix:e===a.topLevelWorkspace?void 0:`${ve.structUtils.stringifyIdent(e.locator)}@`,outputUnreleased:!0},o),Z({version:e===a.topLevelWorkspace||!i.private?void 0:"Unreleased"},s),Z({path:r},h))}async function He(e,{prerelease:t}={}){let{cwd:r,manifest:n,project:i}=e,a=Gt(i.cwd),o=a("conventional-recommended-bump"),s=a("conventional-changelog-preset-loader"),h=i.configuration.get("conventionalChangelogPreset"),w=i.configuration.get("releaseCalverFormat"),u=(0,Re.promisify)(o);if(e===i.topLevelWorkspace)return n.version?Cn(w,n.version,{prerelease:t}):void 0;{let l=await s(h),{recommendedBumpOpts:d}=typeof l=="function"?await(0,Re.promisify)(l)():l,f=await u({config:l,path:r,lernaPackage:ve.structUtils.stringifyIdent(e.locator),whatBump:C=>{let T=new Set(["feat","fix","perf","refactor","revert"]),S=C.some(Fe=>T.has(Fe.type));return(d==null?void 0:d.whatBump)&&S?d.whatBump(C):{}}});if(!t||!f.releaseType)return f.releaseType;let[y]=await Vt({skipUnstable:!0}),[R]=await Vt({skipUnstable:!1}),p=X.default.diff(y,R);if(!(p==null?void 0:p.startsWith("pre")))return t?`pre${f.releaseType}`:f.releaseType;let _=p.slice("pre".length);return $t[_]<$t[f.releaseType]?`pre${f.releaseType}`:"prerelease"}}function Gt(e){let t=(0,Bt.getPnpPath)({cwd:e}).cjs,r=(0,Ht.createRequire)(t);return!process.versions.pnp&&Wt.xfs.existsSync(t)&&r(t).setup(),r}function Cn(e,t,{prerelease:r}={}){let n=typeof r=="string"?r:void 0;if(X.default.prerelease(t))return X.default.inc(t,r?"prerelease":"patch",n);let i=new X.SemVer(Ft.default.inc(e,t,"calendar.micro"));return r&&(i.prerelease=n?[n,0]:[0]),i.format()}var se=class extends Jt.BaseCommand{constructor(){super(...arguments);this.json=q.Option.Boolean("--json",!1,{description:"Format the output as an NDJSON stream"});this.dryRun=q.Option.Boolean("--dry-run",!1,{description:"Prints the recommended version bump to stdout"});this.amend=q.Option.Boolean("--amend",!1,{description:"Amend the previous commit instead of creating a new one"});this.tagHead=q.Option.String("--tag-head","HEAD",{description:"Specify an alternative commit-ish to tag"})}async execute(){let t=await A.Configuration.find(this.context.cwd,this.context.plugins),{project:r}=await A.Project.find(t,this.context.cwd),{stdout:n}=await A.execUtils.execvp("git",["tag","--list"],{cwd:r.cwd,strict:!0}),i=new Set(n.trim().split(/\s+/)),a=`v${r.topLevelWorkspace.locator.reference}`;if(i.has(a))throw new q.UsageError(`${a} has already been released`);return(await A.StreamReport.start({configuration:t,stdout:this.context.stdout,json:this.json},async s=>{let h=r.topLevelWorkspace.getRecursiveWorkspaceChildren().filter(d=>!d.manifest.private&&!i.has(A.structUtils.stringifyLocator(d.locator)));if(!h.length){s.reportWarning(A.MessageName.UNNAMED,"There are no workspaces to tag");return}let w=h.map(({locator:d,manifest:f})=>`${A.structUtils.stringifyIdent(d)}: v${f.version}`).join(`
`),u=["commit","-m",`chore: release ${a}

${w}`];this.amend&&u.push("--amend"),await A.execUtils.execvp("git",u,{cwd:r.cwd,strict:!0});for(let{locator:d}of h){let f=A.structUtils.stringifyLocator(d);await A.execUtils.execvp("git",["tag",f,this.tagHead],{cwd:r.cwd,strict:!0}),s.reportJson({ident:A.structUtils.stringifyIdent(d),tagName:f})}let l="";for await(let d of await oe(r.topLevelWorkspace))l+=d.toString();l=l.split(`
`).slice(2).join(`
`),s.reportJson({ident:A.structUtils.stringifyIdent(r.topLevelWorkspace.locator),tagName:a}),await A.execUtils.execvp("git",["tag","-a",a,"-m",`${a}
${l}`,"--cleanup=verbatim",this.tagHead],{cwd:r.cwd,strict:!0})})).exitCode()}};se.usage=q.Command.Usage({category:"Release-related commands",description:"Commits and tags releases",details:`
      This command will create a release for the current git project.
    `,examples:[["Commits and tags a release for this project's workspaces","yarn release-commit"]]}),se.paths=[["release-commit"]];var Kt=se;var We=M(v("@yarnpkg/cli")),x=M(v("@yarnpkg/core")),j=M(v("@yarnpkg/fslib")),H=M(v("clipanion")),un=M(fn()),Be=M(v("semver")),z=M(v("stream")),Et=M(v("util"));var St="CHANGELOG.md",me=class extends We.BaseCommand{constructor(){super(...arguments);this.json=H.Option.Boolean("--json",!1,{description:"Format the output as an NDJSON stream"});this.dryRun=H.Option.Boolean("--dry-run",!1,{description:"Prints the recommended version bump to stdout"});this.firstRelease=H.Option.Boolean("--first-release",!1,{description:"Skips bumping the version"});this.date=H.Option.String("--date",{description:"Override the release date in the changelog with the provided string"});this.prerelease=H.Option.String("--prerelease",!1,{description:"Add a prerelease identifier to new versions",tolerateBoolean:!0})}async execute(){let t=await x.Configuration.find(this.context.cwd,this.context.plugins),{project:r,workspace:n}=await x.Project.find(t,this.context.cwd);if(!n)throw new We.WorkspaceRequiredError(r.cwd,this.context.cwd);let i=x.structUtils.stringifyIdent(n.locator);return(await x.StreamReport.start({configuration:t,stdout:this.context.stdout,json:this.json},async o=>{var R;let s=n===r.topLevelWorkspace||!n.manifest.private,h=typeof this.prerelease=="string"?this.prerelease:void 0;if(s&&!this.firstRelease){let p=await He(n,{prerelease:this.prerelease});if(!p){o.reportWarning(x.MessageName.UNNAMED,"No commits since last release");return}let _=new Be.SemVer(n.locator.reference);Be.default.valid(p)?(n.manifest.version=p,o.reportJson({ident:i,newVersion:n.manifest.version})):(_.inc(p,h),_.format(),n.manifest.version=_.format(),o.reportJson({ident:i,strategy:p,newVersion:n.manifest.version})),o.reportInfo(x.MessageName.UNNAMED,`Recommended version bump: ${p}`),this.dryRun||await n.persistManifest()}let w=j.ppath.join(n.cwd,St),u=new z.PassThrough;s&&!this.firstRelease?j.xfs.createReadStream(w).on("error",function(p){if(p.code!=="ENOENT")throw p;this.unpipe(u),u.push(null)}).pipe(u):u.push(null);let l=new un.default([await oe(n,{releaseCount:this.firstRelease?0:1},{date:(R=this.date)!=null?R:new Date().toISOString().split("T")[0]}),u]),d="",f=new z.Transform({transform(p,_,C){d+=p.toString(),C(null,p)}}),y=[l,f];if(this.dryRun)y.push(o.createStreamReporter()),await(0,Et.promisify)(z.pipeline)(y);else{let p=j.ppath.join(await j.xfs.mktempPromise(),St);y.push(j.xfs.createWriteStream(p)),await(0,Et.promisify)(z.pipeline)(y),await j.xfs.copyFilePromise(p,w)}o.reportJson({ident:i,changelogPath:w,changelog:d}),this.dryRun||(await x.execUtils.execvp("git",["add",j.Filename.manifest,St],{cwd:n.cwd,strict:!0}),await r.install({cache:await x.Cache.find(t),report:new x.ThrowReport,persistProject:!1}),await x.scriptUtils.maybeExecuteWorkspaceLifecycleScript(n,"postrelease",{report:o})),s&&o.reportInfo(x.MessageName.UNNAMED,`Released v${n.manifest.version}`)})).exitCode()}};me.usage=H.Command.Usage({category:"Release-related commands",description:"Bumps version and generates a changelog for the active workspace",details:`
      This command will prepare the current workspace for a new release.
    `,examples:[["Creates a release for the current workspace","yarn release"],["Creates a release candidate for the current workspace","yarn release --prerelease=rc"]]}),me.paths=[["release"]];var dn=me;var ja={configuration:{releaseCalverFormat:{description:"A CalVer (calendar version) format to use for monorepo versions. Must include the <micro> semver level.",type:Ot.SettingsType.STRING,default:"YY.MM.micro"},conventionalChangelogPreset:{description:"A preset value to pass to conventional-changelog-preset-loader",type:Ot.SettingsType.STRING,default:"conventionalcommits"}},commands:[dn,Kt]},qa=ja;return ka;})();
/*! multistream. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
return plugin;
}
};
